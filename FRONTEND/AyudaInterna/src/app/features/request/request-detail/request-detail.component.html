<div class="container container-sm py-5" *ngIf="solicitud()">
    <div class="card shadow-lg" *ngIf="solicitud() as s">
        <div class="card-header flex justify-between align-center">
            <div>
                <span class="badge mb-2" [ngClass]="'badge-' + s.prioridad.toLowerCase()">{{ s.prioridad }}</span>
                <h1 class="text-2xl font-bold">{{ s.titulo }}</h1>
                <p class="text-muted text-sm">Creado el {{ s.fechaCreacion | date:'medium' }}</p>
            </div>
            <div class="text-right">
                <span class="status-badge" [ngClass]="'status-' + s.estado.toLowerCase().replace('_', '-')">
                    {{ s.estado }}
                </span>
            </div>
        </div>

        <div class="card-body py-4">
            <h3 class="text-lg font-semibold mb-2">Descripción</h3>
            <p class="whitespace-pre-wrap text-text-muted">{{ s.descripcion }}</p>
        </div>

        <div class="card-footer flex justify-between align-center pt-4 border-t border-border">
            <div class="flex gap-2">
                <button routerLink="/dashboard" class="btn btn-secondary">
                    <span class="mr-2">←</span> Volver
                </button>
                <button [routerLink]="['/request/edit', s.id]" class="btn btn-primary">
                    Editar
                </button>
            </div>

            <!-- Operator Controls -->
            <div class="flex gap-2" *ngIf="isOperator()">
                <button (click)="changeStatus('EN_PROCESO')" *ngIf="s.estado === 'NUEVO'"
                    class="btn btn-warning">Atender</button>
                <button (click)="changeStatus('RESUELTO')" *ngIf="s.estado === 'EN_PROCESO'"
                    class="btn btn-success">Resolver</button>
                <button (click)="changeStatus('CERRADO')" *ngIf="s.estado === 'RESUELTO'"
                    class="btn btn-secondary">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<div class="flex justify-center py-10" *ngIf="loading()">
    <div class="spinner"></div>
</div>

<div class="alert alert-danger" *ngIf="error()">
    {{ error() }}
</div>